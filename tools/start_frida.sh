#!/bin/bash -x

USAGE="Start frida server in Device using ADB with option to run custom js frida script\n
	  USAGE: ./start_frida.sh [FRIDA_SCRIPT_PATH.js PACKAGE_NAME]\n
	  FRIDA_SERVER_PATH : Path to custom frida script\n
	  PACKAGE_NAME : name of the Android app's package name\n"

FRIDA_SERVER_PATH=/sdcard/Download/frida_android_x86_64

if [[ $# -eq 1 ]]; then
	echo "Provide both frida script path and package name to run script."
	echo -n $USAGE
	exit 1
fi

echo "[x] Starting Frida Server via ADB"
adb shell $FRIDA_SERVER_PATH
# Wait 2 seconds to let server enough time to start
sleep 2

if [[ $1 -eq 2 ]]; then
	FRIDA_SCRIPT_PATH=$1
	PACKAGE_NAME=$2
	echo -n "[!] Custom Frida script was provided. \n[x] Running script in $FRIDA_SCRIPT_PATH"
	frida -U -f $PACKAGE_NAME -l $FRIDA_SCRIPT_PATH --no-pause
fi