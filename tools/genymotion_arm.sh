#!/bin/bash -x
# ARM translator genymotion script - pushes the ARM translator and flashes it:
USAGE="""ARM translator genymotion script - pushes the ARM translator and flashes it\n
		USAGE:\n
		./genymotion-flash-translator [LOCAL_ARM_TRANSLATOR_ZIP_PATH]"""

LOCAL_ARM_TRANSLATOR_ZIP_PATH=$1

if [ $# -eq 0 ] then
	echo "You have to provide the path for genymotion ARM translator genymotion"
	exit 1
fi

if [ ! -f "$LOCAL_ARM_TRANSLATOR_ZIP_PATH" ] then
    echo "No ARM translator was found in provided path" >&2
    exit 1
fi

GENYMOTION_ARM_TRANSLATOR_ZIP_PATH="/tmp/arm_translator.zip"

echo "[x] pushing arm zip to ${GENYMOTION_ARM_TRANSLATOR_ZIP_PATH}"
adb push $LOCAL_ARM_TRANSLATOR_ZIP_PATH $GENYMOTION_ARM_TRANSLATOR_ZIP_PATH
echo "[x] Flashing arm zip"
adb shell "sh /system/bin/flash-archive.sh ${LOCAL_ARM_TRANSLATOR_ZIP_PATH}"
echo "[x] Rebooting..."
adb reboot
