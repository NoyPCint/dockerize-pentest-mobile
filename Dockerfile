FROM ubuntu:18.04

# Environment Variables
ENV HOME /root
ENV TOOLS ${HOME}/tools
ENV WORDLISTS ${HOME}/wordlists


# Working Directory
WORKDIR ${HOME}

# Copy apks file in current directory
# COPY *.apk ${HOME}/apps/

# Copy scripts and tools
COPY /tools ${TOOLS}

COPY /wordlists ${WORDLISTS}

# Install Essentials
RUN apt-get update && \
	apt-get install -y --no-install-recommends \
    openjdk-8-jdk  
	#     adb  \
#     vim
#     wget \
#     curl \
#     git 
#     net-tools \
#     python \ 
#     python-pip \ 
#     python3 \
#     python3-pip \

# Add custom bashrc aliases and functions
COPY .bashrc /tmp/.bashrc
RUN echo /tmp/.bashrc >> ${HOME}/.bashrc

# Decompile apps
RUN apktool d ${apps}/*.apk -o ${apps}/decompiled/

# Install Dependencies
# RUN apt-get update && \
#     apt-get install -y --no-install-recommends \
#     python3.7 
#     && rm -rf /var/lib/apt/lists/*

# configure python(s)
# RUN python -m pip install --upgrade setuptools && python3 -m pip install --upgrade setuptools && python3.7 -m pip install --upgrade setuptools

# Install Python libraries
# RUN python3 -m pip install frida frida-tools



# Setup JAVA_HOME -- for compling abe jar
# ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64/
# RUN export JAVA_HOME

# Compile abe.jar
# RUN git clone https://github.com/nelenkov/android-backup-extractor.git ${TOOLS}/android-backup-extractor && \
# 	  ${TOOLS}/android-backup-extractor/gradlew 

# RUN git clone https://github.com/m9rco/Genymotion_ARM_Translation ${HOME}/tools/genymotion-ARM-translation


# COPY build/libs/abe-all.jar ${HOME}/abe.jar
# RUN echo 'alias abe="java -jar ${HOME}/abe.jar"' >> ${HOME}/.bashrc


# Install apps
# RUN adb install ${HOME}/apps/*.apk

# Run app in ADB


# TODO: 
# scan apk in MobSF
# Burpsuite URL exporter
# Run grep interesting strings script
#Push frida server according to architecture - using adb getprop


